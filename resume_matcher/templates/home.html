<!DOCTYPE html>
<html>
<head>
    <title>SmartCVMatch - Home</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="container mt-5">
    <h1>Smart Resume Analyzer & Job Matcher</h1>
    <hr>
    <h2>Upload Your Resume (PDF or Text)</h2>
    <form method="post" enctype="multipart/form-data" class="mb-4">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" class="btn btn-primary">Upload</button>
    </form>

    <h3>Uploaded Resumes</h3>
    <ul class="list-group">
        {% for resume, matches in resume_matches %}
            <li class="list-group-item">
                {{ resume.uploaded_at }} - 
                {% if resume.file %}
                    <a href="{{ resume.file.url }}" target="_blank">Download</a>
                {% else %}
                    No file uploaded
                {% endif %}
                {% if resume.skills %}
                    <div class="mt-2">
                        <strong>Extracted Skills:</strong>
                        <span>{{ resume.skills }}</span>
                    </div>
                {% endif %}
                {% if resume.parsed_text %}
                    <div class="mt-2">
                        <strong>Extracted Text:</strong>
                        <pre style="white-space: pre-wrap;">{{ resume.parsed_text|truncatechars:1000 }}</pre>
                    </div>
                {% endif %}
                {% if matches %}
                    <div class="mt-2">
                        <strong>Top Job Matches (TF-IDF):</strong>
                        <ul class="list-group mt-2">
                            {% for match in matches %}
                                <li class="list-group-item">
                                    <strong>{{ match.job.title }}</strong> at {{ match.job.company }}<br>
                                    <em>Score:</em> {{ match.score }}<br>
                                    <em>Description:</em> {{ match.job.description|truncatechars:300 }}
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </li>
        {% empty %}
            <li class="list-group-item">No resumes uploaded yet.</li>
        {% endfor %}
    </ul>
</body>
</html>